<html>
<head>
	<!-- these 4 files always have to be included -->
	<link rel="stylesheet" type="text/css" href="../../lib/css/materialize.css">
	<link rel="stylesheet" type="text/css" href="../../css/adapter.css"/>

	<script type="text/javascript" src="../../lib/js/jquery-3.2.1.min.js"></script>
	<script type="text/javascript" src="../../socket.io/socket.io.js"></script>

	<!-- these files always have to be included -->
	<script type="text/javascript" src="../../js/translate.js"></script>
	<script type="text/javascript" src="../../lib/js/materialize.js"></script>
	<script type="text/javascript" src="../../js/adapter-settings.js"></script>
	
	<script type="text/javascript" src="words.js"></script>
	<script type="text/javascript">
    var onChange;
	var settings = {
		decode: {
			key: 'kolNIO(Z23d$', // used for encrypted password
			fields: ['']
		}
	}
	
	/*
	 * PAGE LOADED
	 */
	$(window).on('load', function()
	{
		M.Tabs.init($('.tabs'));

		var cid = $('#client_id');
		var csecret = $('#client_secret');
		var tbutton = $('#button_gettoken');
		var secure = $('#secure');
		
		/*
		 * bind inputs together
		 */
		$('#token_type-existing, #access_token-existing').on('keyup', function()
		{
			$('#'+$(this).attr('id').replace('-existing', '')).trigger('keyup').val($(this).val());
		})
		
		/*
		 * Checkbox
		 */
		function showHideSettings(state) {$('.hideCol').toggleClass('hidden', state)}
		secure.on('change', function() {showHideSettings(!$(this).prop('checked'))});
		
		/*
		 * Generate token
		 */
		tbutton.on('click', function()
		{
			// client id and secret given, but token missing
			if (cid.val() && csecret.val())
			{
				console.log("Generating token..");
				sendTo(null, 'getToken', {clientId: cid.val(), clientSecret: csecret.val()}, function(res)
				{
					console.log("Received result.");
					if (res !== false)
					{
						$('#token_type, #token_type-existing').val(res.type).focus();
						$('#access_token, #access_token-existing').val(res.access).focus();
						$('#access_token').trigger('change');
					}
					else
						alert('ERROR: Could not fetch token.');
				});
			}
			else
				alert('Fill in Client ID and Client Secret to generate token!');
		});
	});
	</script>
	<script type="text/javascript" src="admin.js"></script>
	<style>
		.m select {display: block !important}
		.hidden {display: none}
		.box {
			margin: 0 .75rem !important;
			background-color: #fff; /*#acd8fa*/
		}
	</style>
</head>
<body>


<div class="m adapter-container" id="settings">

	<div class="row">
		<div class="col s12 m12">
			<p class="translate title">auth</p>
			<p class="translate">auth_info</p>
		</div>
	</div>
	<div class="row" style="margin-bottom: 0">
		<div class="col s12">
			<ul class="tabs">
				<li class="tab col s2"><a href="#gettoken" class="translate active">button_gettoken</a></li>
				<li class="tab col s2"><a href="#providetoken" class="translate">button_providetoken</a></li>
			</ul>
		</div>
	</div>
	
	<!-- Client ID & Secret -->
	<div id="gettoken" class="row box">
		<div class="col s12 m12 page">
			<div class="row">
				<div class="col s12 m12">
					<p class="translate">token_getinfo</p>
				</div>
			</div>
			<div class="row">
				<div class="input-field col s6 m6">
					<input class="value" id="client_id" type="text"/>
					<label for="client_id" class="translate">client_id</label>
				</div>
				<div class="input-field col s6 m6">
					<input class="value" id="client_secret" type="text" />
					<label for="client_secret" class="translate">client_secret</label>
				</div>
			</div>
			
			<!-- Get Token -->
			<div class="row">
				<div class="input-field col s2 m2 center">
					<a class="btn red translate" id="button_gettoken">button_gettoken</a>
				</div>
				<div class="input-field col s5 m5">
					<input class="value" id="token_type" type="text" readonly />
					<label for="token_type" class="translate">token_type-readonly</label>
				</div>
				<div class="input-field col s5 m5">
					<input class="value" id="access_token" type="text" readonly />
					<label for="access_token" class="translate">access_token-readonly</label>
				</div>
			</div>
			
		</div>
	</div>
	
	<!-- Provide Token -->
	<div id="providetoken" class="row box">
		<div class="col s12 m12 page">
			<div class="row">
				<div class="col s12 m12">
					<p class="translate">token_provideinfo</p>
				</div>
			</div>
			<div class="row">
				<div class="input-field col s6 m6">
					<input class="value" id="token_type-existing" type="text" />
					<label for="token_type-existing" class="translate">token_type</label>
				</div>
				<div class="input-field col s6 m6">
					<input class="value" id="access_token-existing" type="text" />
					<label for="access_token-existing" class="translate">access_token</label>
				</div>
			</div>
		</div>
	</div>
	
	<!-- Events -->
	<div class="row">
		<div class="col s12 m12 page">
			<div class="row">
				<div class="col s12 m12">
					<p class="translate title">events</p>
					<p class="translate">events_info</p>
				</div>
			</div>
			<div class="row">
				<div class="input-field col s4 m4">
					<input class="value" id="uri" type="text" placeholder="www.domain.com:1234" />
					<label for="uri" class="translate">uri</label>
				</div>
				
                <div class="input-field col s2 m2">
					<div class="row">
						<div class="col">
							<label for="secure">
								<input class="value" id="secure" type="checkbox" />
								<span class="translate">ssl</span>
							</label>
						</div>
					</div>
					<div class="row">
						<div class="col">
							<label for="selfSigned">
								<input class="value" id="selfSigned" type="checkbox" />
								<span class="translate">selfSigned</span>
							</label>
						</div>
					</div>
                </div>
                <div class="col s2 m2 hideCol">
                    <label class="translate" for="certPublic">public</label>
                    <select id="certPublic" class="value" data-select="certificate" data-type="public"></select>
                </div>
                <div class="col s2 m2 hideCol">
                    <label class="translate" for="certPrivate">private</label>
                    <select id="certPrivate" class="value" data-select="certificate" data-type="private"></select>
                </div>
                <div class="col s2 m2 hideCol">
                    <label class="translate" for="certChained">chained</label>
                    <select id="certChained" class="value" data-select="certificate" data-type="chained"></select>
				</div>
			</div>
		</div>
		
	</div>

</div>

</body>
</html>
